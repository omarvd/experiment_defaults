---
title: "Experiment Status Quo Applications"
subtitle: "Analysis July 19"
author: "Omar Vasquez Duque"
  
output:
  bookdown::pdf_book:
    dev: cairo_pdf
    keep_tex:  true
fontsize: 11pt
toc: false

header-includes:
   - \setlength\parindent{24pt}
   - \usepackage{float}
   - \usepackage{flafter}
   - \usepackage{pdflscape}
   - \usepackage{rotating}
---

```{r include=FALSE}
library(readr)
library(janitor)
library(extrafont)
library(extrafontdb)
library(Cairo)
loadfonts()
library(tidyverse)

source('Theme_Publication.R')

df <- read_csv("Search+Prolific_July+12,+2023_22.29.csv") # Experiment 1

dat <- read_csv("Search+Prolific+July+13_July+14,+2023_14.23.csv") # Experiment 2

options(scipen=999)

```

# Method

## Experimental Design

The data come from two experiments the author ran on Prolific between July 13 and July 14, 2023. Both were trivia games in which the participants had to look for the answers to either 6 or 5 questions (available in the Appendix). The respondents were incentivized to find the correct answers. The regular compensation was \$1 for a 6-minute task, and every participant that found the 5 or 6 correct answers doubled her compensation to \$2. In the first experiment, half of the questions were about popular culture and the other half about weather forecasts. This design intended to compare possible status quo effects in search with those of weather applications. The second experiment focused solely on search engines.

There were two experimental conditions in each study: (i) a *forced-choice condition*, in which each participant chose a search engine and/or a weather application, and (ii) a *default condition*, in which each participant was assigned to a search engine and/or weather application by default. The possible defaults were Google, Bing, Yahoo, and DuckDuck Go for search; and the Weather Channel, AccuWeather, and WeatherUnderground for weather forecasts.[^1]

[^1]: For search, there was an equal probability of being assigned to the forced choice or default condition. In the weather applications part, a 25% chance of either having to choose an app, and a 25% of being assigned to one of the three defaults. The difference is because the author did not have a strong prior about status quo effects in weather applications.

In the first study, each participant was randomly assigned to one of the conditions in each part (i.e.search and weather forecasts). This means a participant could have been assigned to the forced choice condition in the first half of the study and then to a default condition in the second one. The second study focused solely on search. Thus, the five questions presented there were about popular culture. Nonetheless, the author included an additional manipulation in the second study that did not have any effect on the outcomes. Said failed manipulation was the addition of a video the participants had to watch right before seeing the first question, which intended to manipulate people's attention. In both studies, the participants read a multiple choice question and right after responding they had to report what application(s) they had used to find the answer.

```{r include=FALSE}

# Data cleaning for first and second experiment (df = first, dat = second)

df = df %>% 
  clean_names() %>% 
    slice(-c(1,2)) # first two rows repeat var names 

dat = dat %>% 
  clean_names() %>% 
    slice(-c(1,2)) # first two rows repeat var names 

```

```{r include=FALSE}

#More cleaning

df = df %>% 
  filter(consent ==1, #filters out did not consent
         distribution_channel == "anonymous", # filters out previews
         q14 == "5", # attention check
         q15 == "7", # bot check
         !is.na(app_cupertino)) # filters out incompletes

dat = dat %>% 
  filter(consent ==1, #filters out did not consent
         distribution_channel == "anonymous", # filters out previews
         q14 == "5", # attention check
         q15 == "7",
         !is.na(q37))# bot check

```

```{r include=FALSE}
# filter responses too quick and too slow 

df$duration_in_seconds = as.numeric(df$duration_in_seconds) # changes var type

median_completion = median(df$duration_in_seconds) # creates median variable

df2 = df %>% 
  filter(duration_in_seconds >= 0.5 * median_completion & duration_in_seconds <=1.75*median_completion) # n lowers to 257

dat$duration_in_seconds = as.numeric(dat$duration_in_seconds) # changes var type

median_completion2 = median(dat$duration_in_seconds) # creates median variable

dat2 = dat %>% 
  filter(duration_in_seconds >= 0.5 * median_completion2 & duration_in_seconds <=1.75*median_completion2) # n does not change

```

## Sample

Prolific recruited 344 people to participate in the first experiment, and 416 in the second one. After filtering the responses of those who did not pass attention checks, did not complete the questionnaire, and responded either 50% below or 175% above the median completion time, the final sample sample sizes lower to 257 and 319 for the first and second experiments, respectively. The only two restrictions that applied to the participant poll were that they needed to reside in the U.S. and be fluent in English. Both samples were highly educated. Most of the respondents had a college degree. The mean age of the participants was 38 in the first experiment and 42 in the second one. Almost half of the participants identified as female and the rest as male. Slightly below 5% of the samples identified as non-binary or preferred not to respond the question. The Appendix contains two tables displaying descriptive statistics and performing a balance test among the experimental conditions.

```{r include=FALSE}

df2 = df2 %>% 
  mutate(age = 2023-as.numeric(q32),
         education = case_when(q33==1 ~ "some high-school",
                               q33==2 ~ "high school",
                               q33==3 ~ "some college",
                               q33==4 ~ "college degree",
                               q33==5 ~ "graduate degree"),
         computer_use = case_when(q34==1 ~ "up to 2 hours/day",
                                  q34==2 ~ "between 2-4 hours/day",
                                  q34==3 ~ "between 4-6 hours/day",
                                  q34==4 ~ "between 6-8 hours/day",
                                  q34==5 ~ "more than 8 hours/day"),
         gender = case_when(q35==1 ~ "male",
                            q35==2 ~ "female",
                            q35==3 ~ "non-binary",
                            q35==4 ~"prefer not to say"),
         ethnicity = case_when(q36==1 ~ "white",
                               q36==2 ~"african american",
                               q36==3 ~ "asian",
                               q36==4 ~ "american indian",
                               q36==5 ~ "native hawaiian or pacific islander",
                               q36==6 ~ "other",
                               q36==7 ~ "hispanic")) 

               

dat2 = dat2 %>% 
  mutate(age = 2023-as.numeric(q32),
         education = case_when(q33==1 ~ "some high-school",
                               q33==2 ~ "high school",
                               q33==3 ~ "some college",
                               q33==4 ~ "college degree",
                               q33==5 ~ "graduate degree"),
         computer_use = case_when(q34==1 ~ "up to 2 hours/day",
                                  q34==2 ~ "between 2-4 hours/day",
                                  q34==3 ~ "between 4-6 hours/day",
                                  q34==4 ~ "between 6-8 hours/day",
                                  q34==5 ~ "more than 8 hours/day"),
         gender = case_when(q35==1 ~ "male",
                            q35==2 ~ "female",
                            q35==3 ~ "non-binary",
                            q35==4 ~"prefer not to say"),
         ethnicity = case_when(q36==1 ~ "white",
                               q36==2 ~"african american",
                               q36==3 ~ "asian",
                               q36==4 ~ "american indian",
                               q36==5 ~ "native hawaiian or pacific islander",
                               q36==6 ~ "other",
                               q36==7 ~ "hispanic"))       

```

```{r include=FALSE}
# Create treatment vars

df2 = df2 %>% 
  mutate(choice_search = ifelse(survey_version == "1", 1, 0),
         default_search = ifelse(survey_version == "2", 1, 0),
         choice_weather = ifelse(survey_type_weather == "1", 1,0),
         default_weather = ifelse(survey_type_weather == "2", 1, 0))

dat2 = dat2 %>% 
  mutate(Bing_default = ifelse(fl_12_do == "Bing_default", 1, 0))

mean(df2$choice_search) # good balance

mean(df2$default_search) # sanity check. All good

#'* Does not apply to second experiment (only default condition)*
```

```{r include=FALSE}

dfbal = df2 %>% 
  select(age,education, computer_use, gender, ethnicity, choice_search)

datbal = dat2 %>% 
  select(age,education, computer_use, gender, ethnicity, Bing_default)

library(vtable)
```

```{r include=FALSE}

#'*var creation for analysis*
# Create vars for search experiment

dfexp = df2 %>% 
  mutate(chose_google = if_else(choice_screen == 1, 1, 0, NULL),
         chose_duckduckgo = if_else(choice_screen == 2,1,0, NULL),
         chose_bing = if_else(choice_screen == 3, 1,0, NULL),
         chose_ecosia = if_else(choice_screen == 4, 1, 0, NULL),
         chose_yahoo = if_else(choice_screen == 5,1,0, NULL),
         
         choice = factor(case_when(chose_google == 1 ~ "Google",
                            chose_bing == 1 ~ "Bing",
                            chose_duckduckgo == 1 ~ "DuckDuck Go",
                            chose_yahoo == 1 ~ "Yahoo"),
                         levels = c("Google", 
                                    "Bing", 
                                    "DuckDuck Go", 
                                    "Yahoo")),
         
         assigned_google = ifelse(default_assigned=="1",1,0),
         assigned_bing = ifelse(default_assigned=="2",1,0),
         assigned_duckduckgo = ifelse(default_assigned=="4",1,0),
         assigned_yahoo = ifelse(default_assigned=="3",1,0),
         
         used_google_q1 = if_else(grepl("1", se_beatles), 1, 0, NULL),
         used_duckduckgo_q1 = if_else(grepl("4", se_beatles),1,0,NULL),
         used_bing_q1 = if_else(grepl("2", se_beatles),1,0,NULL),
         used_yahoo_q1 = if_else(grepl("3", se_beatles),1,0,NULL),
         used_other_q1 = if_else(grepl("5", se_beatles),1,0,NULL),
         
         used_google_q2 = if_else(grepl("1", se_alcapone), 1, 0, NULL),
         used_duckduckgo_q2 = if_else(grepl("4", se_alcapone),1,0,NULL),
         used_bing_q2 = if_else(grepl("2", se_alcapone),1,0,NULL),
         used_yahoo_q2 = if_else(grepl("3", se_alcapone),1,0,NULL),
         used_other_q2 = if_else(grepl("5", se_alcapone),1,0,NULL),
         
         used_google_q3 = if_else(grepl("1", se_vangogh), 1, 0, NULL),
         used_duckduckgo_q3 = if_else(grepl("4", se_vangogh),1,0,NULL),
         used_bing_q3 = if_else(grepl("2", se_vangogh),1,0,NULL),
         used_yahoo_q3 = if_else(grepl("3", se_vangogh),1,0,NULL),
         used_other_q3 = if_else(grepl("5", se_vangogh),1,0,NULL),
         
         just_one_sq1 = ifelse(str_length(se_beatles)==1, 1,0),
         just_one_sq2 = ifelse(str_length(se_alcapone)==1, 1,0),
         just_one_sq3 = ifelse(str_length(se_vangogh)==1, 1,0),

         google_qual = q60_1,
         bing_qual = q60_2,
         ddg_qual = q60_3,
         yahoo_qual = q60_5,
         
         google_prior = ifelse(grepl("1", q58), 1, 0),
         ddg_pior = ifelse(grepl("2", q58),1, 0),
         bing_prior = ifelse(grepl("3", q58), 1, 0),
         ecosia_prior = ifelse(grepl("4", q58), 1, 0),
         yahoo_prior = ifelse(grepl("5", q58), 1, 0),
         other_prior = ifelse(grepl("6", q58), 1, 0),
         across(starts_with("assigned"), as.factor), # transform all assign vars to factors
         across(ends_with("qual"), as.numeric),
         forced_choice_s = as.factor(choice_search),
         forced_choice_w = as.factor(choice_weather)) # the same but for numeric )
         
     
```

```{r experimental vars second exp, include=FALSE}

#'*Vars for second experiment*'
# The same for second experiment

datexp = dat2 %>% 
  mutate(assigned_google = ifelse(fl_12_do == "Google_default",1,0),
         assigned_bing = ifelse(fl_12_do == "Bing_default",1,0),
         video = ifelse(fl_90_do == "Video",1,0),
         
         used_google_q1 = if_else(grepl("1", se_beatles), 1, 0, NULL),
         used_duckduckgo_q1 = if_else(grepl("4", se_beatles),1,0,NULL),
         used_bing_q1 = if_else(grepl("2", se_beatles),1,0,NULL),
         used_yahoo_q1 = if_else(grepl("3", se_beatles),1,0,NULL),
         used_other_q1 = if_else(grepl("5", se_beatles),1,0,NULL),
         
         used_google_q2 = if_else(grepl("1", se_alcapone), 1, 0, NULL),
         used_duckduckgo_q2 = if_else(grepl("4", se_alcapone),1,0,NULL),
         used_bing_q2 = if_else(grepl("2", se_alcapone),1,0,NULL),
         used_yahoo_q2 = if_else(grepl("3", se_alcapone),1,0,NULL),
         used_other_q2 = if_else(grepl("5", se_alcapone),1,0,NULL),
         
         used_google_q3 = if_else(grepl("1", se_vangogh), 1, 0, NULL),
         used_duckduckgo_q3 = if_else(grepl("4", se_vangogh),1,0,NULL),
         used_bing_q3 = if_else(grepl("2", se_vangogh),1,0,NULL),
         used_yahoo_q3 = if_else(grepl("3", se_vangogh),1,0,NULL),
         used_other_q3 = if_else(grepl("5", se_vangogh),1,0,NULL),
         
         used_google_q4 = if_else(grepl("1", q58_55), 1, 0, NULL),
         used_duckduckgo_q4 = if_else(grepl("4", q58_55),1,0,NULL),
         used_bing_q4 = if_else(grepl("2", q58_55),1,0,NULL),
         used_yahoo_q4 = if_else(grepl("3", q58_55),1,0,NULL),
         used_other_q4 = if_else(grepl("5", q58_55),1,0,NULL),
         
         used_google_q5 = if_else(grepl("1", q60), 1, 0, NULL),
         used_duckduckgo_q5 = if_else(grepl("4", q60),1,0,NULL),
         used_bing_q5 = if_else(grepl("2", q60),1,0,NULL),
         used_yahoo_q5 = if_else(grepl("3", q60),1,0,NULL),
         used_other_q5 = if_else(grepl("5", q60),1,0,NULL),
         
         just_one_sq1 = ifelse(str_length(se_beatles)==1, 1,0),
         just_one_sq2 = ifelse(str_length(se_alcapone)==1, 1,0),
         just_one_sq3 = ifelse(str_length(se_vangogh)==1, 1,0),
         just_one_sq4 = ifelse(str_length(q58_55)==1, 1,0),
         just_one_sq5 = ifelse(str_length(q60)==1, 1,0),
         
         google_qual = q60_1,
         bing_qual = q60_2,
         ddg_qual = q60_3,
         yahoo_qual = q60_5,
         
         google_prior = ifelse(grepl("1", q58_66), 1, 0),
         ddg_pior = ifelse(grepl("2", q58_66),1, 0),
         bing_prior = ifelse(grepl("3", q58_66), 1, 0),
         ecosia_prior = ifelse(grepl("4", q58_66), 1, 0),
         yahoo_prior = ifelse(grepl("5", q58_66), 1, 0),
         other_prior = ifelse(grepl("6", q58_66), 1, 0),
         across(starts_with("assigned"), as.factor), # transform all assign vars to factors
         across(ends_with("qual"), as.numeric))
         
```

```{r Vars for weather apps analysis, include=FALSE}

#'*create vars for weather apps plot*

dfexp = dfexp %>% 
  mutate(chose_wc = if_else(choice_screen_2 == 1, 1, 0, NULL),
         chose_aw = if_else(choice_screen_2 == 2,1,0, NULL),
         chose_wu = if_else(choice_screen_2 == 3, 1,0, NULL),
         
         choice_wa = factor(case_when(chose_wc == 1 ~ "Weather Channel",
                            chose_aw == 1 ~ "AccuWeather",
                            chose_wu == 1 ~ "Weather Underground"),
                         levels = c("Weather Channel", 
                                    "AccuWeather", 
                                    "Weather Underground")),
         
         assigned_wc = ifelse(weather_do %in% "default_wc", 1, 0), 
         assigned_aw = ifelse(weather_do %in% "default_aw", 1, 0),
         assigned_wu = ifelse(weather_do %in% "default_wu", 1, 0),
         
         used_wc_q1 = if_else(grepl("1", app_austin), 1, 0, NULL),
         used_aw_q1 = if_else(grepl("2", app_austin),1,0,NULL),
         used_wu_q1 = if_else(grepl("3", app_austin),1,0,NULL),
         used_other_q1 = if_else(grepl("4", app_austin),1,0,NULL),
         
         used_wc_q2 = if_else(grepl("1", app_cambridge), 1, 0, NULL),
         used_aw_q2 = if_else(grepl("2", app_cambridge),1,0,NULL),
         used_wu_q2 = if_else(grepl("3", app_cambridge),1,0,NULL),
         
         used_wc_q3 = if_else(grepl("1", app_cupertino), 1, 0, NULL),
         used_aw_q3 = if_else(grepl("2", app_cupertino),1,0,NULL),
         used_wu_q3 = if_else(grepl("3", app_cupertino),1,0,NULL),

         ac_qual = q31_1,
         aw_qual = q31_2,
         wu_qual = q31_3,
         
         ac_prior = ifelse(grepl("1", q54), 1, 0),
         aw_pior = ifelse(grepl("2", q54),1, 0),
         wu_prior = ifelse(grepl("3", q54), 1, 0),
         other_prior = ifelse(grepl("4", q54), 1, 0))
         
```

# Results

## Most of the participants clearly preferred the dominant search engine but the preferences for weather applications were divided

```{r message=FALSE, warning=FALSE, include=FALSE}

# choice_se, echo=FALSE, fig.align="center", message=FALSE, warning=FALSE, out.width='0.8\\textwidth'

# Check coding is correct with visualizations

plot.choice.se = dfexp %>% 
  filter(choice_search==1) %>% 
  ggplot(aes(x=choice, fill = choice)) +
  geom_bar(alpha = 0.7) +
  scale_fill_discrete(drop=FALSE) + #to show columns with zeros
          scale_x_discrete(drop=FALSE) + #to show columns with zeros
  # theme_Publication() +
  scale_fill_brewer(palette = "Set2") +
  theme_Publication() +
  theme(text = element_text(family = "LM Roman 10")) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
  theme(legend.position = "none")

```

```{r include=FALSE}

table(dfexp$choice_weather)

plot.choice.wa = dfexp %>% 
  filter(choice_weather==1,
         !is.na(choice_wa)) %>% 
  ggplot(aes(x=choice_wa, fill = choice_wa)) +
  geom_bar(alpha = 0.7) +
  scale_fill_discrete(drop=FALSE) + #to show columns with zeros
          scale_x_discrete(drop=FALSE) + #to show columns with zeros
  # theme_Publication() +
  scale_fill_brewer(palette = "Set2") +
  theme_Publication() +
  theme(text = element_text(family = "LM Roman 10")) +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
  theme(legend.position = "none")

```

```{r include=FALSE}
library(patchwork)
library(ggpubr)

```

Figure \@ref(fig:preferences) below shows the participants' preferences when forced to choose. This is the normative benchmark that discards any potential exploitation of the users' inertia. In search, Google's dominance is clear. Eighty nine percent of the participants chose it. DuckDuck Go ranks second with a mere 8% of the users' preferences. In contrast, the two most popular weather applications showed a more similar share of preferences. The Weather Channel ranks first with 55% of the choices, AccuWeather followed it with 35%, and Weather Underground ranked last with roughly 10% of the preferences.

```{r include=FALSE}
dfexp %>% 
  filter(choice_search==1) %>% 
  summarize(pref_Google = mean(chose_yahoo))

dfexp %>% 
  filter(choice_weather==1) %>% 
  summarize(pref = mean(chose_wc))

dfexp %>% 
  filter(choice_weather==1) %>% 
  summarize(pref = mean(chose_wu))

summary(dfexp$chose_wc, dfexp$chose_aw)

table(dfexp$chose_wu)
```

```{r preferences, echo=FALSE, fig.align="center", fig.cap="Preferences for Search Engines and Weather Apps", message=FALSE, warning=FALSE, out.width='0.7\\textwidth'}

plot.choice.se + plot.choice.wa
```

```{r include=FALSE}

# test = dfexp %>% 
#   mutate(across(starts_with("used"), as.numeric)) 

#' *This worked!!! Saves a lot of time. Mind I should use "across" much more. And apply, lapply, sapply too.*

# test = test %>% 
#   mutate(nbing = used_bing_q1 + used_bing_q2 + used_bing_q3) # This works too!

```

## Strong status quo effects in search and weather applications

A status quo effect refers to the disparity in market share that an application would possess when it is set as the user's default option, as opposed to when the user is compelled to make a choice. This is formally represented as $Pa_i|D_i - Pa_i|C$, where $Pa_i|D_i$ is the probability of choosing application $a$ when it is the default, and $Pa_i|C$ is the probability of choosing the same application when its users are forced to choose their preferred option.

The statistical analysis of this section appraises status quo effects benefiting Bing, DuckDuckGo, the Weather Channel, AccuWeather, and Weather Underground. Yahoo's case is then reported with a mere frequency table. This is because no participant chose Yahoo in the forced choice condition, which makes the statistical analysis impossible.

```{r include=FALSE}
# Create dfs for comparison with forced choice

dfgoogle = dfexp %>% 
  filter(forced_choice_s==1 | assigned_google==1) 

dfbing = dfexp %>% 
  filter(forced_choice_s==1 | assigned_bing==1) 

dfyahoo = dfexp %>% 
  filter(forced_choice_s==1 | assigned_yahoo==1) 

dfddg = dfexp %>% 
  filter(forced_choice_s==1 | assigned_duckduckgo==1) 
```

```{r include=FALSE}
library(jtools)
```

```{r include=FALSE}
#'*creates df for default condition*
# DF for defaults in search
dfexp_def_s = dfexp %>% 
  filter(choice_search==0)
```

```{r wvars, include=FALSE}
# The same for weather apps part

dfexp2 = dfexp %>% 
  mutate(chose_wc = if_else(choice_screen_2 == 1, 1, 0, NULL),
         chose_aw = if_else(choice_screen_2 == 2,1,0, NULL),
         chose_wu = if_else(choice_screen_2 == 3, 1,0, NULL),
         
         choice_wa = factor(case_when(chose_wc == 1 ~ "Weather Channel",
                            chose_aw == 1 ~ "AccuWeather",
                            chose_wu == 1 ~ "Weather Underground"),
                         levels = c("Weather Channel", 
                                    "AccuWeather", 
                                    "WeatherUnderground")),
         
         assigned_wc = ifelse(weather_do %in% "default_wc", 1, 0), 
         assigned_aw = ifelse(weather_do %in% "default_aw", 1, 0),
         assigned_wu = ifelse(weather_do %in% "default_wu", 1, 0),
         
         used_wc_q1 = if_else(grepl("1", app_austin), 1, 0, NULL),
         used_aw_q1 = if_else(grepl("2", app_austin),1,0,NULL),
         used_wu_q1 = if_else(grepl("3", app_austin),1,0,NULL),
         used_other_q1 = if_else(grepl("4", app_austin),1,0,NULL),
         
         used_wc_q2 = if_else(grepl("1", app_cambridge), 1, 0, NULL),
         used_aw_q2 = if_else(grepl("2", app_cambridge),1,0,NULL),
         used_wu_q2 = if_else(grepl("3", app_cambridge),1,0,NULL),
         
         used_wc_q3 = if_else(grepl("1", app_cupertino), 1, 0, NULL),
         used_aw_q3 = if_else(grepl("2", app_cupertino),1,0,NULL),
         used_wu_q3 = if_else(grepl("3", app_cupertino),1,0,NULL),

         ac_qual = q31_1,
         aw_qual = q31_2,
         wu_qual = q31_3,
         
         ac_prior = ifelse(grepl("1", q54), 1, 0),
         aw_pior = ifelse(grepl("2", q54),1, 0),
         wu_prior = ifelse(grepl("3", q54), 1, 0),
         other_prior = ifelse(grepl("4", q54), 1, 0))
         
```

```{r Weatherplots, include=FALSE}

# Weather Applications

dfwc = dfexp2 %>% 
  filter(forced_choice_w==1 | assigned_wc==1) 

dfaw = dfexp2 %>% 
  filter(forced_choice_w==1 | assigned_aw==1) 

dfwu = dfexp %>% 
  filter(forced_choice_w==1 | assigned_wu==1) 

# Weather Channel

sqwcq1= glm(used_wc_q1 ~ forced_choice_w, data=dfwc, family ="binomial")

plotwcq1 = effect_plot(sqwcq1, pred = "forced_choice_w", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1")

plotwcq1 = plotwcq1 + theme_Publication() +
  theme(text = element_text(family = "LM Roman 10"))

sqwcq3= glm(used_wc_q3 ~ forced_choice_w, data=dfwc, family ="binomial")

plotwcq3 = effect_plot(sqwcq3, pred = "forced_choice_w", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1")

plotwcq3= plotwcq3 + theme_Publication() +
  theme(text = element_text(family = "LM Roman 10"))

#AccuWeather
sqawq1= glm(used_aw_q1 ~ forced_choice_w, data=dfaw, family ="binomial")

plotawq1 = effect_plot(sqawq1, pred = "forced_choice_w", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1")

plotawq1 = plotawq1 + theme_Publication() +
  theme(text = element_text(family = "LM Roman 10"))

sqawq3= glm(used_aw_q3 ~ forced_choice_w, data=dfaw, family ="binomial")

plotawq3 = effect_plot(sqawq3, pred = "forced_choice_w", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1")

plotawq3 = plotawq3 + theme_Publication() +
  theme(text = element_text(family = "LM Roman 10"))

#Weather Underground
sqwuq1= glm(used_wu_q1 ~ forced_choice_w, data=dfwu, family ="binomial")

plotwuq1 = effect_plot(sqwuq1, pred = "forced_choice_w", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1")

plotwuq1 = plotwuq1 + theme_Publication() +
  theme(text = element_text(family = "LM Roman 10"))

sqwuq3= glm(used_wu_q3 ~ forced_choice_w, data=dfwu, family ="binomial")

plotwuq3 = effect_plot(sqwuq3, pred = "forced_choice_w", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1")

plotwuq3 = plotwuq3 + theme_Publication() +
  theme(text = element_text(family = "LM Roman 10"))

```

As just noted, most of the respondents in the forced choice condition chose Google. Only a few chose Bing (4%), and 8% chose DuckDuck Go. However, when the participants were assigned to any rival of Google by default, a very substantial part of the respondents used the default, and not only in the first question but also in the third one. Ninety percent of those assigned to DuckDuck Go used it in question 1, compared to 80% of those assigned to Bing, and 60% of those assigned to Yahoo. The effect lowered by roughly 10% in question 3. The following plots show the operationalization of status quo effects with forced choice as the benchmark. Google is the only search engine that does not directly benefit from its default position. This is because its share of preferences does not change substantially when it is people's default and when users are forced to choose.

The weather application data show a similar effect. Figure \@ref(fig:Sqweather) displays the three applications show a much higher use rate when they are assigned as people's default than when people are forced to choose. Weather Underground was the least sticky default. Fewer people stuck to it in question 1, and more switched to another application by question 3.

```{r means, include=FALSE}

dfbing %>% 
  filter(choice_search==0) %>% 
  summarize(use_Bing = mean(used_bing_q1))


dfddg %>% 
  filter(choice_search==0) %>% 
  summarize(use_DDG = mean(used_duckduckgo_q1))

dfyahoo %>% 
  filter(choice_search==0) %>% 
  summarize(use_Yahoo = mean(used_yahoo_q1))

dfbing %>% 
  filter(choice_search==0) %>% 
  summarize(use_Bingq3 = mean(used_bing_q3))


dfddg %>% 
  filter(choice_search==0) %>% 
  summarize(use_DDGq3 = mean(used_duckduckgo_q3))

dfyahoo %>% 
  filter(choice_search==0) %>% 
  summarize(use_Yahooq3 = mean(used_yahoo_q3))


dfexp %>% 
  filter(choice_search==1) %>% 
  summarize(pref_Bing = mean(chose_bing))
```

```{r Bplot, include=FALSE}
# Bing Q1
sqbingq1= glm(used_bing_q1 ~ forced_choice_s, data=dfbing, family ="binomial")

#check effect on quality

qualbing = lm(bing_qual ~ forced_choice_s, data = dfbing)

summary(qualbing)

plotbingq1 = effect_plot(sqbingq1, pred = "forced_choice_s", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1") 

plotbingq1 = plotbingq1 +   theme_Publication() +
  theme(text = element_text(family = "LM Roman 10"))

# Bing Q3
sqbingq3= glm(used_bing_q3 ~ forced_choice_s, data=dfbing, family ="binomial")

#check effect on quality


plotbingq3 = effect_plot(sqbingq3, pred = "forced_choice_s", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1") 

plotbingq3 = plotbingq3 +   theme_Publication() +
  theme(text = element_text(family = "LM Roman 10"))
```

```{r DDGplot, include=FALSE}
sqddgq1= glm(used_duckduckgo_q1 ~ forced_choice_s, data=dfddg, family ="binomial")


plotddgq1 = effect_plot(sqddgq1, pred = "forced_choice_s", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1") 

plotddgq1 = plotddgq1 +   theme_Publication() +
  theme(text = element_text(family = "LM Roman 10")) + ylab("used_ddg_q1")

# DDG Q3
sqddgq3= glm(used_duckduckgo_q3 ~ forced_choice_s, data=dfddg, family ="binomial")

#check effect on quality

plotddgq3 = effect_plot(sqddgq3, pred = "forced_choice_s", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1") 

plotddgq3 = plotddgq3 +   theme_Publication() +
  theme(text = element_text(family = "LM Roman 10")) + ylab("used_ddg_q3")

```

```{r Gplot, include=FALSE}
sqgoogleq1= glm(used_google_q1 ~ forced_choice_s, data=dfgoogle, family ="binomial")


plotgoogleq1 = effect_plot(sqgoogleq1, pred = "forced_choice_s", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1") 

plotgoogleq1 = plotgoogleq1 +   theme_Publication() +
  theme(text = element_text(family = "LM Roman 10"))

# DDG Q3
sqgoogleq3= glm(used_google_q3 ~ forced_choice_s, data=dfgoogle, family ="binomial")

#check effect on quality

plotgoogleq3 = effect_plot(sqgoogleq3, pred = "forced_choice_s", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1") 

plotgoogleq3 = plotgoogleq3 +   theme_Publication() +
  theme(text = element_text(family = "LM Roman 10"))
```

```{r include=FALSE}
library(ggpubr)
```

```{r Sqsearch, echo=FALSE, fig.align="center", fig.cap="Status Quo Search Engines", message=FALSE, warning=FALSE, out.width='0.7\\textwidth'}

seplotlist = ggarrange(plotbingq1, plotddgq1, plotgoogleq1, plotbingq3, plotddgq3, plotgoogleq3, ncol = 3, nrow = 2) 

seplotlist

#'*this is the main plot!!*
```

```{r Sqweather, echo=FALSE, fig.align="center", fig.cap="Status Quo Weather Apps", message=FALSE, warning=FALSE, out.width='0.7\\textwidth'}

seplotlistw = ggarrange(plotwcq1, plotawq1, plotwuq1, plotwcq3, plotawq3, plotwuq3, ncol = 3, nrow = 2) 

seplotlistw

#'*main plot for weather applications*

```

```{r SotherD, include=FALSE}
#Calculate with other se as default

sqgq1b= glm(used_google_q1 ~ assigned_google, data=dfexp_def_s, family ="binomial")


plotgq1b = effect_plot(sqgq1b, pred = "assigned_google", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1") 

plotgq1b = plotgq1b +   theme_Publication() +
  theme(text = element_text(family = "LM Roman 10")) 

#G q3
sqgq3b= glm(used_google_q3 ~ assigned_google, data=dfexp_def_s, family ="binomial")


plotgq3b = effect_plot(sqgq3b, pred = "assigned_google", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1") 

plotgq3b = plotgq3b +   theme_Publication() +
  theme(text = element_text(family = "LM Roman 10")) 

#Bing

sqbingq1b= glm(used_bing_q1 ~ assigned_bing, data=dfexp_def_s, family ="binomial")


plotbingq1b = effect_plot(sqbingq1b, pred = "assigned_bing", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1") 

plotbingq1b = plotbingq1b +   theme_Publication() +
  theme(text = element_text(family = "LM Roman 10")) 

# Bing Q3
sqbingq3b= glm(used_bing_q3 ~ assigned_bing, data=dfexp_def_s, family ="binomial")


plotbingq3b = effect_plot(sqbingq3b, pred = "assigned_bing", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1") 

plotbingq3b = plotbingq3b +   theme_Publication() +
  theme(text = element_text(family = "LM Roman 10")) 

# DDG

sqddgq1b= glm(used_duckduckgo_q1 ~ assigned_duckduckgo, data=dfexp_def_s, family ="binomial")


plotddgq1b = effect_plot(sqddgq1b, pred = "assigned_duckduckgo", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1") 

plotddgq1b = plotddgq1b +   theme_Publication() +
  theme(text = element_text(family = "LM Roman 10")) + ylab("used_ddg_q1") + xlab("assigned_ddg")

# DDG Q3
sqddgq3b= glm(used_duckduckgo_q3 ~ assigned_duckduckgo, data=dfexp_def_s, family ="binomial")


plotddgq3b = effect_plot(sqddgq3b, pred = "assigned_duckduckgo", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1") 

plotddgq3b = plotddgq3b +   theme_Publication() +
  theme(text = element_text(family = "LM Roman 10")) + ylab("used_ddg_q3") + xlab("assigned_ddg")

#Yahoo

sqyahooq1b= glm(used_yahoo_q1 ~ assigned_yahoo, data=dfexp_def_s, family ="binomial")


plotyahooq1b = effect_plot(sqyahooq1b, pred = "assigned_yahoo", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1") 

plotyahooq1b = plotyahooq1b +   theme_Publication() +
  theme(text = element_text(family = "LM Roman 10")) 

# Yahoo Q3
sqyahooq3b= glm(used_yahoo_q3 ~ assigned_yahoo, data=dfexp_def_s, family ="binomial")


plotyahooq3b = effect_plot(sqyahooq3b, pred = "assigned_yahoo", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1") 

plotyahooq3b = plotyahooq3b +   theme_Publication() +
  theme(text = element_text(family = "LM Roman 10")) 

```

```{r include=FALSE}
dfexp_def_s %>% 
  filter(assigned_yahoo==1) %>% 
  summarise(q1 = mean(used_yahoo_q1),
            q2 = mean(used_yahoo_q2),
            q3 = mean(used_yahoo_q3))
```

```{r calcs, include=FALSE}
dfexp_def_s %>% 
  filter(assigned_google==0) %>% 
  summarize(m = mean(used_google_q3))
```

```{r Wdefsplot, include=FALSE}
dfwadef = dfexp2 %>% 
  filter(choice_weather==0) %>% 
  mutate(across(starts_with("assigned"), as.factor)) 

# Weather Channel

sqwcq1b= glm(used_wc_q1 ~ assigned_wc, data=dfwadef, family ="binomial")

plotwcq1b = effect_plot(sqwcq1b, pred = "assigned_wc", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1")

plotwcq1b = plotwcq1b + theme_Publication() +
  theme(text = element_text(family = "LM Roman 10"))

sqwcq3b= glm(used_wc_q3 ~ assigned_wc, data=dfwadef, family ="binomial")

plotwcq3b = effect_plot(sqwcq3b, pred = "assigned_wc", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1")

plotwcq3b= plotwcq3b + theme_Publication() +
  theme(text = element_text(family = "LM Roman 10"))

#AccuWeather
sqawq1b= glm(used_aw_q1 ~ assigned_aw, data=dfwadef, family ="binomial")

plotawq1b = effect_plot(sqawq1b, pred = "assigned_aw", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1")

plotawq1b = plotawq1b + theme_Publication() +
  theme(text = element_text(family = "LM Roman 10"))

sqawq3b= glm(used_aw_q3 ~ assigned_aw, data=dfwadef, family ="binomial")

plotawq3b = effect_plot(sqawq3b, pred = "assigned_aw", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1")

plotawq3b = plotawq3b + theme_Publication() +
  theme(text = element_text(family = "LM Roman 10"))

#Weather Underground
sqwuq1b= glm(used_wu_q1 ~ assigned_wu, data=dfwadef, family ="binomial")

plotwuq1b = effect_plot(sqwuq1b, pred = "assigned_wu", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1")

plotwuq1b = plotwuq1b + theme_Publication() +
  theme(text = element_text(family = "LM Roman 10"))

sqwuq3b= glm(used_wu_q3 ~ assigned_wu, data=dfwadef, family ="binomial")

plotwuq3b = effect_plot(sqwuq3b, pred = "assigned_wu", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1")

plotwuq3b = plotwuq3b + theme_Publication() +
  theme(text = element_text(family = "LM Roman 10"))

```

```{r wcalcs, include=FALSE}
dfexp2 %>% 
  filter(forced_choice_w==0) %>% 
  summarize(wcq1 = mean(used_wc_q1),
            wcq2 = mean(used_wc_q2),
            wcq3 = mean(used_wc_q3),
            awq1 = mean(used_aw_q1),
            awq2 = mean(used_aw_q2),
            awq3 = mean(used_aw_q3),
            wuq1 = mean(used_wu_q1),
            wuq2 = mean(used_wu_q2),
            wuq3 = mean(used_wu_q3))
```

## Downward Trend of Default Effects in Search

Bing and Yahoo exhibited stronger default effects in question 1 than question 3. This was also the Weather Underground's case. This trend motivated the author to run a follow-up experiment with five questions, in which there was just a default condition. In this second experiment, the participants were randomly assigned to Google or Bing by default (with an equal probability). Figure \@ref(fig:Bing1v5) shows how Bing's default effect goes down from roughly 75% in question 1 to 50% in question 5 (McNemar's Chi-squared test p \< 0.01).

Relatedly, the use of Google when Bing is the default increases substantially comparing question 1 and question 5. While only a quarter of the participants assigned to Bing by default used Google in question one, almost half did so to find the answer to the last question.

```{r chisqb1v5, include=FALSE}

mcnemar.test(datexp$used_bing_q1, datexp$used_bing_q5)

lm(data=datexp, formula = used_bing_q5 ~ assigned_bing + assigned_bing*used_bing_q1) # not sure about how to model this
```

```{r include=FALSE}
e2.googleq1= glm(used_google_q1 ~ assigned_bing, data=datexp, family ="binomial")

e2.plotgoogleq1 = effect_plot(e2.googleq1, pred = "assigned_bing", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1")

e2.plotgoogleq1 = e2.plotgoogleq1 + theme_Publication() +
  theme(text = element_text(family = "LM Roman 10"))


e2.googleq5= glm(used_google_q5 ~ assigned_bing, data=datexp, family ="binomial")

e2.plotgoogleq5 = effect_plot(e2.googleq5, pred = "assigned_bing", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1")

e2.plotgoogleq5 = e2.plotgoogleq5 + theme_Publication() +
  theme(text = element_text(family = "LM Roman 10"))

```

```{r include=FALSE}
#'* Second experiment*
lm(data = datexp, used_bing_q1 ~ assigned_bing)

e2.test = lm(data = datexp, used_bing_q1 ~ assigned_bing:bing_prior + bing_qual)
summary(e2.test) #there is an interaction effect. Prior use moderates the effect of the default

e2.bingq1 = glm(data = datexp, used_bing_q1 ~ assigned_bing + bing_prior, family = "binomial")

summary(e2.bingq1)

#'*visualization*
# E2. Bing Q1
e2.sqbingq1= glm(used_bing_q1 ~ assigned_bing, data=datexp, family ="binomial")

e2.plotbingq1 = effect_plot(e2.sqbingq1, pred = "assigned_bing", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1")

e2.plotbingq1 = e2.plotbingq1 + 
  theme_Publication() + 
  theme(text = element_text(family = "LM Roman 10"))

e2.sqbingq5= glm(used_bing_q5 ~ assigned_bing, data=datexp, family ="binomial")

e2.plotbingq5 = effect_plot(e2.sqbingq5, pred = "assigned_bing", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1")

e2.plotbingq5 = e2.plotbingq5 +
  theme_Publication() + 
  theme(text = element_text(family = "LM Roman 10"))
```

```{r Bing1v5, echo=FALSE, fig.align="center", fig.cap="Status Quo Bing Q1 and Q5", message=FALSE, warning=FALSE, out.width='0.6\\textwidth'}
e2.plotbingq1 + e2.plotbingq5
```

```{r GoogBD1v5, echo=FALSE, fig.align="center", fig.cap="Use of Google When Bing is the Default Q1 and Q5", message=FALSE, warning=FALSE, out.width='0.6\\textwidth'}
e2.plotgoogleq1 + e2.plotgoogleq5
```

## Google's Use Goes Down When Another Search Engine is the Users' Default

As noted, Google does not benefit from a default effect. However, Google's rivals do. And when a rival of Google increases its use, Google's use goes down. In fact, only roughly 20% of the participants used Google to find the answer to the first question when assigned to any of Google's rivals by default. However, the number goes up to 32% in question 3. Figure \@ref(fig:Sqsearchb) shows this effect. It also shows that Google was the only option the participants tended to use in addition to their default.

[Check what happened experiment 2]

```         
```

Now, do the same for Q5

```{r include=FALSE}

```

See how this effect affects Google

Mind there are two ways to operationalize the effect:

1)  compared with choice-screen

2)  compared with any other default

```{r Sqsearchb, echo=FALSE, fig.align="center", fig.cap="Search Engine Use. default vs. Other as Default", message=FALSE, warning=FALSE, out.width='0.65\\textwidth'}
seplotlistb = ggarrange(plotbingq1b, plotddgq1b, plotgq1b, plotbingq3b, plotddgq3b, plotgq3b, ncol = 3, nrow = 2) 

seplotlistb
```

```{r Plotwb, include=FALSE}
seplotlistwb = ggarrange(plotwcq1b, plotawq1b, plotwuq1b, plotwcq3b, plotawq3b, plotwuq3b, ncol = 3, nrow = 2) 

seplotlistwb
```

## Default affects people's perceptions about the quality of each application

## Video had no effect. Probably everyone paid attention. Check number of correct answers

See if video had an effect... It did not work out. No difference

```{r include=FALSE}
# Creates status quo variable (for Q1)
datexp = datexp %>% 
  mutate(statquo = ifelse(assigned_bing ==1 & used_bing_q1==1 | assigned_google ==1 & used_google_q1==1, 1,0),
         video = as.factor(video))

mean(datexp$statquo)

datbing = datexp %>% 
  filter(assigned_bing==1) # New DF to compare just those assigned to Bing

glmvideo = glm(data=datexp, formula=statquo ~ video, family = "binomial")

summary(glmvideo)



glm.video = effect_plot(glmvideo, pred = "video", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1")

glm.video

```

```{r include=FALSE}

```

Substantial effect! lowers use of Google!

## Big regression general analysis status quo effect

There si something wrong with the default data set. Showing NAs in assigned to a

```{r include=FALSE}
dfexp_def_s = dfexp_def_s %>% 
  mutate(statquo_sq1 = ifelse(assigned_bing==1 & used_bing_q1==1 | assigned_google==1 & used_google_q1==1 | assigned_duckduckgo==1 & used_duckduckgo_q1==1 | assigned_yahoo==1 & used_yahoo_q1==1, 1, 0),
         statquo_sq3= ifelse(assigned_bing==1 & used_bing_q3==1 | assigned_google==1 & used_google_q3==1|assigned_duckduckgo==1 & used_duckduckgo_q3==1 | assigned_yahoo==1 & used_yahoo_q3==1, 1, 0),
         prior_use = ifelse(assigned_google==1 & google_prior==1 | assigned_bing==1 & bing_prior==1 | assigned_duckduckgo==1 & ddg_pior==1 | assigned_yahoo==1 & yahoo_prior==1,1,0),
         explor_sq1 = ifelse(str_length(se_beatles)>1, 1,0),
         age = 2023 - as.numeric(q32),
         age_c = case_when(age<30 ~ "18-29",
                           age >29 & age <40 ~ "30-39",
                           age >39 & age <50 ~ "40-49",
                           age>49 & age <60 ~ "50-59",
                           age>59 ~ "60 +"))


lm(data=dfexp_def_s, formula= statquo_sq1 ~  prior_use)

lm(data=dfexp_def_s, formula= statquo_sq1 ~ prior_use + age_c)

```

Data defaults without Google

```{r include=FALSE}
dfexp_def_s2 = dfexp_def_s %>% 
  filter(assigned_google==0)
```

```{r eval=FALSE, include=FALSE}
lm(data=dfexp_def_s2, formula= statquo_sq1 ~ explor_sq1 + prior_use)

glmsqs1 = glm(data=dfexp_def_s2, formula= statquo_sq1 ~ explor_sq1 + prior_use, family = "binomial")

summary(glmsqs1)
```

Interesting coefficients, qualitatively. Now, run glm because p\>1

```{r include=FALSE}
mean(dfexp_def_s$statquo_sq1) 
```

## Check if those who use the default use another one too!

This is important. q1 only a few use more than one, q3 many more explore.

```{r include=FALSE}
# Create var for analysis

dfexp_def_s = dfexp_def_s %>% 
  mutate(se_assigned = case_when(assigned_google==1 ~ "Google",
                                 assigned_bing==1 ~ "Bing",
                                 assigned_duckduckgo==1 ~"DuckDuck Go",
                                 assigned_yahoo==1 ~ "Yahoo"))
```

Code below irrelevant. q1 only one person used more than one

```{r include=FALSE}
# glm_just_one= glm(just_one_sq1 ~ se_assigned, data=dfexp_def_s, family ="binomial")
# 
# plot_just_one_sq1 = effect_plot(glm_just_one, pred = "se_assigned", interval = TRUE, plot.points = TRUE, jitter = c(0.2, 0.01), point.alpha = 0.4, colors = "Qual1")
# 
# plot_just_one_sq1

table(dfexp_def_s$se_assigned, dfexp_def_s$just_one_sq1)

table(dfexp_def_s$se_assigned, dfexp_def_s$just_one_sq2)

table(dfexp_def_s$se_assigned, dfexp_def_s$just_one_sq3)
```

Code above is not what I need. The relevant variable is stat_quo_qi \* just_one_qi

```{r include=FALSE}
dfexp_def_s = dfexp_def_s %>% 
  mutate(just_default_sq1 = ifelse(statquo_sq1==1 & just_one_sq1==1,1,0),
         just_default_sq3 = ifelse(statquo_sq3==1 & just_one_sq3==1,1,0))
```

```{r include=FALSE}
table(dfexp_def_s$se_assigned, dfexp_def_s$just_default_sq1)

table(dfexp_def_s$se_assigned, dfexp_def_s$just_default_sq3)
```

### Now with the second experiment

```{r include=FALSE}
datexp = datexp %>% 
  mutate(se_assigned = case_when(assigned_google==1 ~ "Google",
                                 assigned_bing==1 ~ "Bing"),
         statquo_sq1 = ifelse(assigned_bing==1 & used_bing_q1==1 | assigned_google==1 & used_google_q1==1, 1, 0),
         statquo_sq2 = ifelse(assigned_bing==1 & used_bing_q2==1 | assigned_google==1 & used_google_q2==1, 1, 0),
         statquo_sq3= ifelse(assigned_bing==1 & used_bing_q3==1 | assigned_google==1 & used_google_q3==1, 1, 0),
         statquo_sq4 = ifelse(assigned_bing==1 & used_bing_q4==1 | assigned_google==1 & used_google_q4==1, 1, 0),
         statquo_sq5 = ifelse(assigned_bing==1 & used_bing_q5==1 | assigned_google==1 & used_google_q5==1, 1, 0),
         prior_use = ifelse(assigned_google==1 & google_prior==1 | assigned_bing==1 & bing_prior==1,1,0),
         just_default_sq1 = ifelse(statquo_sq1==1 & just_one_sq1==1,1,0),
         just_default_sq2 = ifelse(statquo_sq2==1 & just_one_sq3==1,1,0),
         just_default_sq3 = ifelse(statquo_sq3==1 & just_one_sq3==1,1,0),
         just_default_sq4 = ifelse(statquo_sq4==1 & just_one_sq3==1,1,0),
         just_default_sq5 = ifelse(statquo_sq5==1 & just_one_sq3==1,1,0))
```

```{r include=FALSE}
table(datexp$se_assigned, datexp$just_default_sq1)

table(datexp$se_assigned, datexp$just_default_sq2)

table(datexp$se_assigned, datexp$just_default_sq3)

table(datexp$se_assigned, datexp$just_default_sq4)

table(datexp$se_assigned, datexp$just_default_sq5)
```

Interesting result. More people tend to use Bing exclusively over time.

# Results Weather Apps

```{r include=FALSE}


         
```

```{r include=FALSE}
dfaw = dfexp2 %>% 
  filter(forced_choice_w==1| assigned_aw==1) 
  

```

One plot for sq q1 for each (a1_q1, a2_q1, a3_q1)

Another for sq q3 for each (a1_q3, a2_q3, a3_q3)

```{r include=FALSE}

#A
```

```{r include=FALSE}



```

```{r include=FALSE}

# Convert vars for analysis

test = dfexp2 %>% 
  mutate(across(starts_with("used"), as.numeric)) 

#' *This worked!!! Saves a lot of time. Mind I should use "across" much more. And apply, lapply, sapply too.*

test = test %>% 
  mutate(nbing = used_bing_q1 + used_bing_q2 + used_bing_q3) # This works too!


```

```{r}

```

Effect_plot to show correlations browsers/s.engines controlling for changes in OSX market shares

# Appendix

```{r, echo=FALSE, results='asis'}

sumtable(data= dfbal, group = 'choice_search', group.test = T, out = "latex")
```

```{r, echo=FALSE, results='asis'}

sumtable(data= datbal, group = 'Bing_default', group.test = T, out = "latex")

```
